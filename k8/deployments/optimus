apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: optimus
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: optimus
    spec:
      containers:
        - image: registry.runnable.com/runnable/optimus:v5.1.1
          name: optimus
          args:
            - /bin/sh
            - '-c'
            - ulimit -c unlimited && /usr/local/bin/npm start
          env:
            - name: NODE_ENV
              value: production-gamma
            - name: DATADOG_HOST
              value: 10.4.6.251
            - name: DATADOG_PORT
              value: '8125'
            - name: PORT
              value: '80'
            - name: AWS_ACCESS_KEY_ID
              value: AKIAJPA2ZYSVVA5V7XXQ
            - name: AWS_SECRET_ACCESS_KEY
              value: 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
            - name: S3_DEPLOY_KEY_BUCKET
              value: runnable.deploykeys.production-beta
            - name: LOG_LEVEL
              value: trace
            - name: HOME
              value: /
            - name: PATH
              value: >-
                ./node_modules/.bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
            - name: LC_ALL
              value: en_US.UTF-8
          ports:
            - containerPort: 80
