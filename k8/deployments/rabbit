apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: rabbit
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: rabbit
    spec:
      containers:
        - image: rabbitmq:3.5.3-management
          name: rabbit
          args:
            - rabbitmq-server
          env:
            - name: PATH
              value: >-
                /usr/lib/rabbitmq/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
            - name: RABBITMQ_LOGS
              value: '-'
            - name: RABBITMQ_SASL_LOGS
              value: '-'
            - name: RABBITMQ_VERSION
              value: 3.5.3-1
          volumeMounts:
            - name: rabbitmq-config
              mountPath: /etc/rabbitmq
          command:
            - /docker-entrypoint.sh
          ports:
            - containerPort: 15672
            - containerPort: 5672
      volumes:
        - name: rabbitmq-config
          configMap:
            name: rabbitmq-config
