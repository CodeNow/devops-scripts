apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: nginx
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
        - image: nginx:1.10
          name: nginx
          args:
            - nginx
            - '-g'
            - daemon off;
          env:
            - name: PATH
              value: '/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'
            - name: NGINX_VERSION
              value: 1.10.1-1~jessie
          volumeMounts:
            - name: nginx-runnable-gamma-com-certs
              mountPath: /etc/ssl/certs/runnable-gamma.com
            - name: nginx-conf
              mountPath: /etc/nginx
            - name: nginx-api-conf
              mountPath: /etc/nginx/sites-enabled
            - name: nginx-mixpanel
              mountPath: /etc/nginx/other-sites-enabled
          ports:
            - containerPort: 443
            - containerPort: 80
      volumes:
        - name: nginx-runnable-gamma-com-certs
          configMap:
            name: nginx-runnable-gamma-com-certs
        - name: nginx-conf
          configMap:
            name: nginx-conf
        - name: nginx-api-conf
          configMap:
            name: nginx-api-conf
        - name: nginx-mixpanel
          configMap:
            name: nginx-mixpanel
