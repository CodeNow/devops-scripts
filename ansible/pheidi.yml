---
- hosts: consul
- hosts: mongodb
- hosts: rabbitmq
- hosts: pheidi

- hosts: builder
  vars_files:
    - group_vars/alpha-pheidi.yml
  roles:
  - { role: notify, rollbar_token: "{{ pheidi_rollbar_token }}" }
  - { role: tls-client, tls_service: mongodb, tags: [ tls ] }
  - { role: builder, tags: [build] }
  - { role: push, tags: [ push ]  }

- include: aws/pheidi.yml
- include: deploy/pheidi.yml
