name: big-poppa-http
service_name: big-poppa

hosted_ports: ["{{ big_poppa_port }}"]

envs:
  - name: PORT
    value: "{{ big_poppa_port }}"
  - name: ROLLBAR_KEY
    value: "{{ big_poppa_http_rollbar_token }}"
  - name: NEW_RELIC_APP_NAME
    value: "{{ big_poppa_new_relic_app_name | default('ansible_undefined') }}"
  - name: NEW_RELIC_LICENSE_KEY
    value: "{{ new_relic_license_key | default('ansible_undefined') }}"
  - name: NEW_RELIC_LOG_LEVEL
    value: "fatal"
  - name: NEW_RELIC_NO_CONFIG_FILE
    value: "true"

dockerfile_enviroment: [
  "NPM_TOKEN {{ npm_token }}"
]

dockerfile_pre_install_commands: [
  "apt-get update",
  "apt-get install postgresql-client=9.4+165+deb8u2 -y",
  "echo '//registry.npmjs.org/:_authToken=${NPM_TOKEN}' > .npmrc"
]

container_run_args: npm run start-http
