name: kartographer

repo: "git@github.com:CodeNow/{{ name }}.git"

inject_ca: false
build_with_dockerfile: true

node_version: "4.2.3"
npm_version: "4.0.3"

kube_config: /keys
kube_config_name: kube-config

container_envs:
  - name: CONFIG_FILE_PATH
    value: "{{ kube_config }}/{{ kube_config_name }}"
  - name: DATADOG_HOST
    valueFrom: "spec.nodeName"
  - name: DATADOG_PORT
    value: "{{ datadog_port }}"
  - name: HELLO_RUNNABLE_GITHUB_TOKEN
    value: "{{ kartographer_hello_runnable_github_token }}"
  - name: NODE_ENV
    value: "{{ node_env }}"
  - name: RABBITMQ_HOSTNAME
    value: "{{ rabbit_host_address }}"
  - name: RABBITMQ_PASSWORD
    value: "{{ rabbit_password }}"
  - name: RABBITMQ_PORT
    value: "{{ rabbit_port }}"
  - name: RABBITMQ_USERNAME
    value: "{{ rabbit_username }}"
  # - name: ROLLBAR_KEY
  #   value: "{{ kartographer_rollbar_token }}"
  - name: RUNNABLE_API_URL
    value: "{{ api_url }}"
  - name: WORKER_MAX_NUM_RETRIES
    value: "2"

volume_mounts:
  - name: "{{ name }}-keys"
    path: "{{ kube_config }}"
    kind: configMap
