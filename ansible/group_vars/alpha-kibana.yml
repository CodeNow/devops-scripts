name: kibana

hosted_ports: ["5601"]

# anti-anand setting
stop_time: 5

# For master redis (allows us to hit kibana from the outside)
redis_key: "frontend:{{ name }}.{{ domain }}"
is_redis_update_required: 'yes'

# for container kill_start
container_image: runnable/elk
container_tag: latest

container_run_opts: >
  -d
  -v /opt/elk/elasticsearch:/var/lib/elasticsearch
  -p 9200:9200
  -p {{ hosted_ports[0] }}:{{ hosted_ports[0] }}
  -e REDIS_HOST="{% if staging_logstash_broker_host is defined %}{{ staging_logstash_broker_host }}{% else %}{{ hostvars[groups['logstash-broker'][0]]['ansible_default_ipv4']['address'] }}{% endif %}"
  -e REDIS_PORT="{% if staging_logstash_broker_port is defined %}{{ staging_logstash_broker_port }}{% else %}{{ 6379 }}{% endif %}"
  --name kibana

dockerfile: kibana/Dockerfile
