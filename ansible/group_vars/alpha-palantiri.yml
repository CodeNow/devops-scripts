name: "palantiri"

# copy certs into docker image:
docker_client_certs: true

container_image: "registry.runnable.com/runnable/{{ name }}"
container_tag: "{{ git_branch }}"
repo: "git@github.com:CodeNow/{{ name }}.git"
node_version: "4.2.2"
npm_version: "2.14.7"

# container settings
dockerfile_environment: |
  ENV CONSUL_HOST {{ consul_host_address }}:{{ consul_api_port }}
  ENV NODE_ENV {{ node_env }}
  ENV DATADOG_HOST {{ datadog_host_address }}
  ENV DATADOG_PORT {{ datadog_port }}
  ENV RABBITMQ_HOSTNAME {{ rabbit_host_address }}
  ENV RABBITMQ_PASSWORD {{ rabbit_password }}
  ENV RABBITMQ_PORT {{ rabbit_port }}
  ENV RABBITMQ_USERNAME {{ rabbit_username }}
  ENV ROLLBAR_KEY {{ palantiri_rollbar_key }}
  ENV RSS_LIMIT 2000000
  ENV LOG_LEVEL_STDOUT trace
  ENV SWARM_HOSTNAME {{ swarm_host_address }}
  ENV SWARM_PORT {{ swarm_master_port }}

container_run_opts: >
  -h {{ name }}
  -d
