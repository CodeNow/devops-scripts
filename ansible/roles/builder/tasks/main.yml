---
# commands to build an image
- name: create build folder
  sudo: yes
  file:
    path="{{ build_dir }}/{{ name }}"
    state=directory

- name: copy dockerfile to build folder
  sudo: yes
  template:
    src={{ dockerfile }}
    dest="{{ build_dir }}/{{ name }}"
  tags: 'genDockerfile'

- name: build docker image and tag
  command: sudo docker build --no-cache --tag="{{ container_image }}:{{ container_tag }}" "{{ build_dir }}/{{ name }}"

- name: push docker image
  when: not do_not_push
  command: sudo docker push {{ container_image }}:{{ container_tag }}
