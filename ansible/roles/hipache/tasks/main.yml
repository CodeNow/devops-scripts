---
- name: create certs path
  become: true
  file:
    path=/etc/ssl/certs/{{ domain }}
    state=directory

- name: create private cert path
  become: true
  file:
    path=/etc/ssl/private
    state=directory

# the keys below must be placed inside devops-scripts/ansible/roles/hipache/files
- name: copy ca.crt
  tags: certs
  become: true
  copy:
    src={{ domain }}/ca.pem
    dest=/etc/ssl/certs/{{ domain }}/ca.crt

- name: copy {{ domain }}.crt
  tags: certs
  become: true
  copy:
    src={{ domain }}/cert.pem
    dest=/etc/ssl/certs/{{ domain }}/{{ domain }}.crt

- name: copy private ssl key
  tags: certs
  become: true
  copy:
    src={{ domain }}/key.pem
   dest=/etc/ssl/private/{{ domain }}.key

- name: create hipache config directory
  become: true
  file:
    path=/opt/hipache-conf
    state=directory

- name: copy configs
  become: true
  template:
    src=config.json
    dest=/opt/hipache-conf
