---
- name: create certs path
  sudo: yes
  file:
    path=/etc/ssl/certs/{{ domain }}
    state=directory

- name: create private cert path
  sudo: yes
  file:
    path=/etc/ssl/private
    state=directory

# the keys below must be placed inside devops-scripts/ansible/roles/hipache/files
- name: copy ca.crt
  sudo: yes
  template:
    src={{ domain }}-ca.crt
    dest=/etc/ssl/certs/ca.crt

- name: copy {{ domain }}.crt
  sudo: yes
  template:
    src={{ domain }}.crt
    dest=/etc/ssl/certs/{ domain }}.crt

- name: copy private ssl key
  sudo: yes
  template:
    src={{ domain }}.key
    dest=/etc/ssl/private/{{ domain }}.key

- name: create hipache config directory
  sudo: yes
  file:
    path=/opt/hipache-conf
    state=directory

- name: copy configs
  sudo: yes
  template:
    src=config.json
    dest=/opt/hipache-conf
